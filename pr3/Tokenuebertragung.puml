@startuml
title Token-Ãœbertragung im Token-Ring

participant "Registry-Service" as Registry
participant "Client 1" as C1
participant "Client 2" as C2
participant "Client 3" as C3

== Registrierung & Ringaufbau ==
C1 -> Registry : register(name, ip, port)
Registry -> C1 : return clientId=1
C2 -> Registry : register(name, ip, port)
Registry -> C2 : return clientId=2
C3 -> Registry : register(name, ip, port)
Registry -> C3 : return clientId=3

C1 -> Registry : ringinfo(clientId=1)
Registry -> C1 : prev=3, next=2

C2 -> Registry : ringinfo(clientId=2)
Registry -> C2 : prev=1, next=3

C3 -> Registry : ringinfo(clientId=3)
Registry -> C3 : prev=2, next=1

== Token-Zirkulation ==
note over C1: Client 1 startet das Token
C1 -> C1 : hatToken = true
C1 -> C1 : Roboter steuern (controlRobotWithToken)

C1 -> C2 : sendToken(payload: currentHolderId=C1)
C2 -> C2 : receiveToken(payload)
C2 -> C2 : hatToken = true
C2 -> C2 : Roboter steuern
C2 -> C3 : sendToken(payload: currentHolderId=C2)

C3 -> C3 : receiveToken(payload)
C3 -> C3 : hatToken = true
C3 -> C3 : Roboter steuern
C3 -> C1 : sendToken(payload: currentHolderId=C3)

== Wiederholung ==
note over C1,C3
Token rotiert kontinuierlich im Ring
end note


@enduml
