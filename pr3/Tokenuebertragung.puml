@startuml
title Token-Ãœbertragung im Token-Ring

participant "Registry-Service" as Registry
participant "Terminal-Client A" as C1
participant "Terminal-Client B" as C2
participant "Terminal-Client C" as C3
participant "Robot-Node" as Robot

== Registrierung & Ringaufbau ==
C1 -> Registry : register(...)
Registry --> C1 : clientId = 1
C2 -> Registry : register(...)
Registry --> C2 : clientId = 2
C3 -> Registry : register(...)
Registry --> C3 : clientId = 3

C1 -> Registry : ring_info(1)
Registry --> C1 : prev = 3, next = 2

note over C1
Client mit kleinster ID
erzeugt initial das Token
end note

== Token-Zirkulation ==
C1 -> C1 : hasToken = true

note right of C1
Optional:
Wenn ein Benutzerbefehl
vorliegt, wird ein Roboter
gesteuert
end note

C1 -> Robot : MOVE / SHUTDOWN
Robot --> C1 : ok

C1 -> C2 : token
C2 -> C2 : receiveToken()
C2 -> C2 : hasToken = true

note right of C2
Kein Befehl vorhanden:
Token wird automatisch
weitergereicht
end note

C2 -> C3 : token
C3 -> C3 : receiveToken()
C3 -> C3 : hasToken = true

C3 -> C1 : token

note over C1,C3
Das Token rotiert zyklisch
zwischen allen Clients
end note

@enduml
